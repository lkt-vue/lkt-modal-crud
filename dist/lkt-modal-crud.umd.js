(function(e,n){typeof exports=="object"&&typeof module<"u"?module.exports=n(require("vue"),require("lkt-modal")):typeof define=="function"&&define.amd?define(["vue","lkt-modal"],n):(e=typeof globalThis<"u"?globalThis:e||self,e.LktModalCrud=n(e.Vue,e.LktModal))})(this,function(e,n){"use strict";const y={name:"LktModalCrud",inheritAttrs:!1},C=e.defineComponent({...y,props:{modelValue:{type:Object,required:!1,default:()=>({})},palette:{type:String,default:""},size:{type:String,default:""},preTitle:{type:String,default:""},title:{type:String,default:""},loading:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},disabledClose:{type:Boolean,default:!1},disabledVeilClick:{type:Boolean,default:!1},modalName:{type:String,default:""},modalKey:{type:[String,Number],default:"_"},zIndex:{type:Number,default:500},editModeText:{type:String,default:"Edition Mode"},saveText:{type:String,default:"Save"},dropText:{type:String,default:"Delete"},readResource:{type:String,required:!0},createResource:{type:String,required:!1},updateResource:{type:String,required:!1},dropResource:{type:String,required:!1},readData:{type:Object,required:!1,default:()=>({})},createData:{type:Object,required:!1,default:()=>({})},updateData:{type:Object,required:!1,default:()=>({})},dropData:{type:Object,required:!1,default:()=>({})},saveIsCreate:{type:Boolean,default:!1},createConfirm:{type:String,default:""},updateConfirm:{type:String,default:""},dropConfirm:{type:String,default:""},createDisabled:{type:Boolean,default:!1},updateDisabled:{type:Boolean,default:!1},dropDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","read","created","updated","dropped","perms"],setup(t,{emit:c}){const a=t,f=e.useSlots(),b=c,s=e.ref(a.modelValue),k=e.ref([]),i=e.ref(!1),S=e.ref(null),d=e.ref(a.loading),m=e.ref(!1);e.watch(()=>a.modelValue,r=>s.value=r),e.watch(()=>a.loading,r=>d.value=r),e.watch(s,()=>b("update:modelValue",s.value));const g=()=>{n.closeModal(a.modalName,a.modalKey)},w=e.computed(()=>a.saveIsCreate?a.createConfirm:a.updateConfirm),D=e.computed(()=>a.saveIsCreate?a.createResource:a.updateResource),x=e.computed(()=>a.saveIsCreate?a.createData:a.updateData),V=e.computed(()=>a.saveIsCreate?a.createDisabled:a.updateDisabled),v=r=>{d.value=!1,m.value=!0};return(r,l)=>{const p=e.resolveComponent("lkt-button"),B=e.resolveComponent("lkt-field-switch"),M=e.resolveComponent("lkt-item-crud"),R=e.resolveComponent("lkt-modal");return e.openBlock(),e.createBlock(R,{"pre-title":t.preTitle,title:t.title,"modal-name":t.modalName,"modal-key":t.modalKey,"z-index":t.zIndex,palette:t.palette,size:t.size,loading:d.value,"show-close":t.showClose,"disabled-close":t.disabledClose,"disabled-veil-click":t.disabledVeilClick},e.createSlots({"button-drop":e.withCtx(({item:o})=>[e.unref(f)["button-drop"]?e.renderSlot(r.$slots,"button-drop",{key:0,item:o,editMode:i.value}):e.withDirectives((e.openBlock(),e.createBlock(p,{key:1,palette:"danger",disabled:t.dropDisabled,"confirm-modal":t.dropConfirm,resource:t.dropResource,"resource-data":t.dropData,onLoading:l[0]||(l[0]=u=>d.value=!0),onLoaded:l[1]||(l[1]=u=>d.value=!1),onClick:g},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.dropText),1)]),_:1},8,["disabled","confirm-modal","resource","resource-data"])),[[e.vShow,!d.value&&!m.value]])]),"button-save":e.withCtx(({item:o})=>[e.unref(f)["button-save"]?e.renderSlot(r.$slots,"button-save",{key:0,item:o,editMode:i.value}):e.withDirectives((e.openBlock(),e.createBlock(p,{key:1,palette:"success",disabled:V.value,"confirm-modal":w.value,resource:D.value,"resource-data":x.value,onLoading:l[2]||(l[2]=u=>d.value=!0),onLoaded:l[3]||(l[3]=u=>d.value=!1)},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.saveText),1)]),_:1},8,["disabled","confirm-modal","resource","resource-data"])),[[e.vShow,!d.value&&!m.value]])]),"button-edition":e.withCtx(({item:o})=>[e.withDirectives(e.createVNode(B,{modelValue:i.value,"onUpdate:modelValue":l[4]||(l[4]=u=>i.value=u),label:t.editModeText},null,8,["modelValue","label"]),[[e.vShow,!d.value&&!m.value]])]),default:e.withCtx(()=>[e.createVNode(M,{ref:o=>S.value=o,modelValue:s.value,"onUpdate:modelValue":l[5]||(l[5]=o=>s.value=o),"read-resource":t.readResource,"read-data":t.readData,"create-resource":t.createResource,"update-resource":t.updateResource,"drop-resource":t.dropResource,onPerms:l[6]||(l[6]=o=>k.value=o),onRead:l[7]||(l[7]=o=>d.value=!1),onError:v},{item:e.withCtx(({item:o})=>[e.renderSlot(r.$slots,"item",{item:o,editMode:i.value})]),_:3},8,["modelValue","read-resource","read-data","create-resource","update-resource","drop-resource"])]),_:2},[e.unref(f)["pre-title"]?{name:"pre-title",fn:e.withCtx(({item:o})=>[e.renderSlot(r.$slots,"pre-title",{item:o,editMode:i.value})]),key:"0"}:void 0]),1032,["pre-title","title","modal-name","modal-key","z-index","palette","size","loading","show-close","disabled-close","disabled-veil-click"])}}});return{install:(t,c)=>{t.component("lkt-modal-crud",C)}}});
